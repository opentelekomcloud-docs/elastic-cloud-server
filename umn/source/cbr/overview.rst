.. _en-us_topic_0000001128445638:

Overview
========

What Is CBR?
------------

Cloud Backup and Recovery (CBR) enables you to back up cloud servers and disks with ease. In case of a virus attack, accidental deletion, or software or hardware fault, you can restore data to any point in the past when the data was backed up.

CBR protects your services by ensuring the security and consistency of your data.

What Are the Differences Between Backup, Snapshot, and Image?
-------------------------------------------------------------

You can use the cloud server backup function to create ECSs and the cloud disk backup function to create EVS disks.

An image can be a system disk image, data disk image, or full-ECS image.

+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Backup Type         | Backup Object                                      | Application Scenario                                                                                                                                                                                                                                                                           | Differences and Advantages                                                                                                                                                                                             |
+=====================+====================================================+================================================================================================================================================================================================================================================================================================+========================================================================================================================================================================================================================+
| Cloud server backup | All disks (system and data disks) on an ECS        | -  **Hacker attacks and viruses**                                                                                                                                                                                                                                                              | All disks on an ECS are backed up at the same time, ensuring data consistency.                                                                                                                                         |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use cloud server backup to restore data to the latest backup point at which the ECS has not been affected by hacker attacks and viruses.                                                                                                                                            | In addition, you can configure backup policies for automatic backup.                                                                                                                                                   |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Accidental data deletion**                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use cloud server backup to restore data to the backup point prior to the accidental deletion.                                                                                                                                                                                       |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Application update errors**                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use cloud server backup to restore data to the backup point prior to the application update.                                                                                                                                                                                        |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **System breakdown**                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use cloud server backup to restore an ECS to the backup point in time prior to system breakdown.                                                                                                                                                                                    |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Cloud disk backup   | One or more specified disks (system or data disks) | -  **Only data disks need to be backed up, because the system disk does not contain users' application data.**                                                                                                                                                                                 | Backup data is stored in OBS, instead of disks. This ensures data restoration upon disk data loss or corruption.                                                                                                       |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use cloud disk backup to back up and restore data if an EVS disk is faulty or encounters a logical error, for example, accidental deletion, hacker attacks, and virus infection.                                                                                                    | Backup cost is reduced without compromising data security.                                                                                                                                                             |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Use backups as baseline data.**                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    After a backup policy has been set, the EVS disk data can be automatically backed up based on the policy. You can use the backups created on a timely basis as the baseline data to create new EVS disks or to restore the backup data to EVS disks.                                        |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Snapshot            | One or more specified disks (system or data disks) | -  **Routine data backup**                                                                                                                                                                                                                                                                     | -  The snapshot data is stored with the disk data to facilitate rapid data back up and restoration.                                                                                                                    |
|                     |                                                    |                                                                                                                                                                                                                                                                                                | -  You can create snapshots to rapidly save disk data as it was at specified points in time. You can also use snapshots to create new disks so that the created disks will contain the snapshot data in the beginning. |
|                     |                                                    |    You can create snapshots for disks on a timely basis and use snapshots to recover your data in case that data loss or data inconsistency occurred due to misoperations, viruses, or attacks.                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Rapid data restoration**                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can create a snapshot or multiple snapshots before an application software upgrade or a service data migration. If an exception occurs during the upgrade or migration, service data can be rapidly restored to the time point when the snapshot was created.                           |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    For example, if ECS A cannot be started due to a fault occurred in system disk A, you can create disk B using an existing snapshot of system disk A and attach disk B to a properly running ECS, for example ECS B. In this case, ECS B can read the data of system disk A from the disk B. |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Rapid deployment of multiple services**                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use a snapshot to create multiple EVS disks containing the same initial data, and these disks can be used as data resources for various services,                                                                                                                                   |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    for example data mining, report query, and development and testing. This method protects the initial data and creates disks rapidly, meeting the diversified service data requirements.                                                                                                     |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | .. note::                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    -  A snapshot can be rolled back only to its source disk. Rollback to another disk is not possible.                                                                                                                                                                                         |                                                                                                                                                                                                                        |
|                     |                                                    |    -  If you have reinstalled or changed the ECS OS, snapshots of the system disk are automatically deleted. Snapshots of the data disks can be used as usual.                                                                                                                                 |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| System disk image   | System disk                                        | -  **Rapid system recovery**                                                                                                                                                                                                                                                                   | A system disk image can help an ECS with OS damaged to quickly change its OS.                                                                                                                                          |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can create a system disk image for the system disk of an ECS before OS change, application software upgrade, or service data migration. If an exception occurs during the migration, you can use the system disk image to change ECS OS or create a new ECS.                            |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Rapid deployment of multiple services**                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use a system disk image to quickly create multiple ECSs with the same OS, thereby quickly deploying services these ECSs.                                                                                                                                                            |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Data disk image     | Specific data disk                                 | **Rapid data replication**                                                                                                                                                                                                                                                                     | A data disk image can replicate all data on a disk and create new EVS disks. The EVS disks can be attached to other ECSs for data replication and sharing.                                                             |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | You can use a data disk image to create multiple EVS disks containing the same initial data, and then attach these disks to ECSs to provide data resources for multiple services.                                                                                                              |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Full-ECS image      | All disks (system and data disks) on an ECS        | -  **Rapid system recovery**                                                                                                                                                                                                                                                                   | A full-ECS image facilitates service migration.                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can create a full-ECS image for the system disk and data disks of an ECS before OS change, application software upgrade, or service data migration. If an exception occurs during the migration, you can use the full-ECS image to change ECS OS or create a new ECS.                   |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    | -  **Rapid deployment of multiple services**                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                        |
|                     |                                                    |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                        |
|                     |                                                    |    You can use a full-ECS image to quickly create multiple ECSs with the same OS and data, thereby quickly deploying services these ECSs.                                                                                                                                                      |                                                                                                                                                                                                                        |
+---------------------+----------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _en-us_topic_0000001128445638__section10399144613501:

CBR Architecture
----------------

CBR consists of backups, vaults, and policies.

-  **Backup**

   A backup is a copy of a particular chunk of data and is usually stored elsewhere so that it may be used to restore the original data in the event of data loss. CBR supports the following backup types:

   -  Cloud server backup: This type of backup uses the consistency snapshot technology for disks to protect data of ECSs and BMSs. The backups of servers without deployed databases are common server backups, and those of servers with deployed databases are application-consistent backups.
   -  Cloud disk backup: This type of backup provides snapshot-based data protection for EVS disks.

-  **Vault**

   CBR uses vaults to store backups. Before creating a backup, you need to create at least one vault and associate the resource you want to back up with the vault. Then the backup of the resource is stored in the associated vault.

   Vaults can be classified into two types: backup vaults and replication vaults. Backup vaults store backups, whereas replication vaults store replicas of backups.

   The backups of different types of resources must be stored in different types of vaults.

-  **Policy**

   Policies are divided into backup policies and replication policies.

   -  Backup policies: To perform automatic backups, configure a backup policy by setting the execution times of backup tasks, the backup cycle, and retention rules, and then apply the policy to a vault.
   -  Replication policies: To automatically replicate backups or vaults, configure a replication policy by setting the execution times of replication tasks, the replication cycle, and retention rules, and then apply the policy to a vault. Replicas of backups must be stored in replication vaults.

.. _en-us_topic_0000001128445638__section696712594578:

Backup Mechanism
----------------

A full backup is performed only for the first backup and backs up all used data blocks.

For example, if the size of a disk is 100 GB and the used space is 40 GB, the 40 GB of data is backed up.

An incremental backup backs up only the data changed since the last backup, which is storage- and time-efficient.

When a backup is deleted, only the data blocks that are not depended on by other backups are deleted, so that other backups can still be used for restoration. Both a full backup and an incremental backup can restore data to the state at a given backup point in time.

When creating a backup of a disk, CBR also creates a snapshot for it. Every time a new disk backup is created, CBR deletes the old snapshot and keeps only the latest snapshot.

CBR stores backup data in OBS, enhancing backup data security.

.. _en-us_topic_0000001128445638__section533362013:

Backup Options
--------------

CBR supports one-off backup and periodic backup. A one-off backup task is manually created by users and is executed only once. Periodic backup tasks are automatically executed based on a user-defined backup policy.

.. table:: **Table 1** One-off backup and periodic backup

   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
   | Item                   | One-Off Backup                                                                                                                                                                                         | Periodic Backup                                                                                                                             |
   +========================+========================================================================================================================================================================================================+=============================================================================================================================================+
   | Backup policy          | Not required                                                                                                                                                                                           | Required                                                                                                                                    |
   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
   | Number of backup tasks | One manual backup task                                                                                                                                                                                 | Periodic tasks driven by a backup policy                                                                                                    |
   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
   | Backup name            | User-defined backup name, which is **manualbk\_**\ *xxxx* by default                                                                                                                                   | System-assigned backup name, which is **autobk\_**\ *xxxx* by default                                                                       |
   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
   | Backup mode            | Full backup for the first time and incremental backup subsequently, by default                                                                                                                         | Full backup for the first time and incremental backup subsequently, by default                                                              |
   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
   | Application scenario   | Executed before patching or upgrading the OS or upgrading an application on a resource. A one-off backup can be used to restore the resource to the original state if the patching or upgrading fails. | Executed for routine maintenance of a resource. The latest backup can be used for restoration if an unexpected failure or data loss occurs. |
   +------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------+
