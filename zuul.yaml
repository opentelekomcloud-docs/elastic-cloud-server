---
- job:
    name: build-otc-docs-ecs-dev-guide
    parent: otc-tox-docs
    description: |
      Build dev-guide document. This is only run on master branch of a project.
    timeout: 1800
    vars:
      tox_envlist: dg
      tox_pdf_envlist: dg-pdf-docs
      tox_skip_pdf: false
      sphinx_build_dir: dev/build
      sphinx_source_dir: dev/source
      sphinx_pdf_files:
        - "dev-{{ zuul.project.short_name }}.pdf"
      opensearch_doc_category: "dev"
    # We only publish the master (main) branch, so no need to run
    # for changes on other branches.
    branches:
      - master
      - main

- job:
    name: promote-docs-ecs-dev-guide
    parent: otc-promote-docs-hc-base
    description: |
      Publish dev guide document.
      This job is run in a promote pipeline to publish documents built
      in the gate pipeline.
    # We only publish the master branch, so no need to run
    # for changes on other branches.
    branches:
      - master
      - main
    final: true
    vars:
      container: "dev"
      prefix: "{{ zuul.project.short_name }}"
      download_artifact_job: build-otc-docs-ecs-dev-guide
      make_public: true

- project:
    merge-mode: squash-merge
    default-branch: main
    templates:
      - api-ref-hc-jobs
      - umn-hc-jobs
    check:
      jobs:
        - noop
        - build-otc-docs-ecs-dev-guide:
            files: &dev-triggers
              - dev/.*
    gate:
      jobs:
        - build-otc-docs-ecs-dev-guide:
            files: *dev-triggers
    promote:
      jobs:
        - promote-docs-ecs-dev-guide:
            files: *dev-triggers
